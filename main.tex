\documentclass[
  normalmargins,
  11pt,
  openany,
  onehalfspacing,
]{ut-thesis}

% packages
\usepackage{etoolbox}
\usepackage{aasmacros}
\usepackage[round]{natbib}
\bibliographystyle{my_abbrvnat}

\usepackage[french,english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\newrobustcmd*{\andname}{et}
  \addto \extrasenglish {\renewrobustcmd*{\andname}{and}}
  \addto \extrasfrench  {\renewrobustcmd*{\andname}{et}}

\newrobustcmd*{\liaisonname}{et}
  \addto \extrasenglish {\renewrobustcmd*{\liaisonname}{and}}
  \addto \extrasfrench  {\renewrobustcmd*{\liaisonname}{et}}


\usepackage[autostyle]{csquotes} 
\usepackage{threeparttable}
\usepackage{epigraph}
\setlength{\epigraphwidth}{0.6\textwidth}
\setlength{\epigraphrule}{0pt}


\usepackage[colorlinks,
    linkcolor={black},
    citecolor={blue},
    urlcolor={black}]{hyperref} % for links
\usepackage{graphicx} % for embedding graphics
%\usepackage{booktabs} % for pretty tables
\usepackage{caption}
\usepackage{subcaption}
\usepackage[nottoc]{tocbibind} % adds lot and lof to toc
\usepackage{pdfpages}
\usepackage{float}
\usepackage{amsmath, bm, bbm}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{physics}
\usepackage{cancel}
\usepackage{tikz}
\usetikzlibrary{arrows.meta}
\usepackage{enumitem}
\usepackage{lipsum}
\newcommand{\subscript}[2]{$#1 _ #2$}

\newcommand{\KL}{\mathrel{\Vert}}
\DeclareRobustCommand{\bbone}{\text{\usefont{U}{bbold}{m}{n}1}}
\DeclareMathOperator{\EX}{\mathbb{E}}% expected value

\def\frenchlistfigurename{Liste des figures}
\def\frenchlisttablename{Liste des tableaux}

\usepackage[nogroupskip,nonumberlist,acronym,toc,sort=def]{glossaries} 
\newglossary[slg]{symbolslist}{syi}{syg}{Symboles}
%\newglossary[slg]{acronyms}{syi}{syg}{Abbréviations}

\usepackage{glossary_entry}
\makeglossaries 

% author data
\author{Alexandre Adam}
\university{Université de Montréal}
\sujet{physique}
\membrejury{Yashar Hezaveh}
\directeur{Laurence Perreault-Levasseur}
\president{René Doyon}
\faculty{Faculté des arts et des sciences}
\title{Reconstruction libre de lentilles gravitationnelles de type galaxie-galaxie avec les machines à inférence récurentielle}
%\title{La reconstruction d'image dans le contexte des problèmes inverses mal posées et non-linéaires avec les machines à inférence récurentielles}
\degree{Maître ès sciences (M.Sc.)}
\department{Département de physique}
\gradyear{2022}
\date{31 décembre 2022}

\allowdisplaybreaks
\begin{document}
% Add items to glossary without displaying them
  \selectlanguage{french}
  \frontmatter
    \maketitle
    \maketitletwo
        \selectlanguage{french}
    \begin{resume}
	Les lentilles gravitationnelles de type galaxie-galaxie se produisent lorsque la lumière d'une galaxie 
	en arrière-plan est déviée par le champ gravitationnel d'une galaxie en avant-plan, formant 
	des images multiples ou même des anneaux d'Einstein selon le point de vue d'un observateur sur Terre. 
	Ces phénomènes permettent non seulement 
	d'étudier les galaxies lointaines, magnifiées par la galaxie-lentille, mais aussi de comprendre la distribution 
	de masse de la galaxie-lentille et de son environnement, une opportunité unique pour 
	sonder la matière noire contenue dans ces galaxies. 
	Or, les méthodes traditionnelles pour analyser ces systèmes requièrent une quantité 
	significative de temps ordinateur (de quelques heures à quelques jours), sans compter le temps des 
	experts pour faire converger les analyses MCMC requises pour obtenir les paramètres d'intérêts. 
	Ce problème est significatif, considérant qu'il est projeté que  
	les grands relevés du ciel comme ceux qui seront menés aux observatoires Rubin et Euclid découvrirons plusieurs 
	centaines de milliers de lentilles gravitationnelles.  
	De plus, le Télescope géant européen (ELT), faisant usage de la technologie d'optique adaptative, 
	et le télescope spatial James Webb, vont nous offrir une vue sans précédent de ces systèmes, avec un 
	pouvoir de résolution qui rendra possible certaines analyses comme la recherche de halo de matière noire froide, 
	longtemps prédite par le modèle cosmologique standard $\Lambda$CDM. Les approximations traditionnelles faites pour 
	simplifier la reconstruction des lentilles gravitationnelles ne seront plus valides dans ce régime.

	Dans ce mémoire, je présente un travail qui s'attaque à ces deux problèmes. Je présente une 
	méthode d'optimisation basée sur les machines à inférence récurentielle pour reconstruire 
	deux images, soit celle d'une galaxie en arrière-plan et une image pour la distribution de masse 
	de la galaxie en avant-plan. La représentation paramétrique choisie a le potentiel de reconstruire 
	une classe très large de lentilles gravitationnelles, incluant des halos et sous-halos de matière noire, 
	ce qu'on démontre dans ce travail en utilisant des profiles de densité réalistes provenant de 
	la simulation cosmologique hydrodynamique IllustrisTNG. 
	Nos reconstructions atteignent un niveau de réalisme jamais atteint auparavant 
        et s'exécutent sur une fraction du temps requis pour exécuter une analyse traditionnelle, soit un pas 
	significatif vers une méthode pouvant adresser le défi d'analyser autant de systèmes complexes et variés en 
	un temps à l'échelle humaine.
        
       \noindent 
        \textbf{Mots-clés:} Lentilles gravitationnelles ---
                        Simulations astrophysiques  ---
                        Inférence non-paramétrique ---
                        Réseaux neuronaux convolutifs.
    \end{resume}

	\selectlanguage{english}
    \begin{abstract}
	Galaxy-Galaxy gravitational lenses is a phenomenon that happens when the light coming from a background 
	galaxy is bent by the gravitational field of a foreground galaxy, producing multiple images or even 
	Einstein ring images of the background source from the point of view of an observer on Earth.
	These phenomena allow us to study in detail the morphology of the background galaxy, magnified 
	by the lens, but also study the mass density distribution of the lens and its environment, thus offering a 
	unique probe of dark matter in lensing galaxies.
	Traditional methods studying these systems often need significant compute time (from hours to days), 
	and this is without taking into account the time spent by experts 
	to make the MCMC chains required to obtain parameters 
	of interest converge. This problem is significant, considering that 
	large surveys from observatories like Rubin and Euclid are projected to discover hundreds of thousands of 
	gravitational lenses. Moreover, the Extremely Large Telescope (ELT), using adaptive optics, and the 
	James Webb Space Telescope will offer an unprecedented glimpse of these systems, with a resolving power 
	predicted to enable searches for cold dark matter subhalos --- objects long predicted by the standard cosmological model
	$\Lambda$CDM. Approximations used to make analysis tractable in traditional methods will no longer be valid 
	in that regime.

	In this thesis, I present a method that aims to address these two issues. The method, 
	based on Recurrent Inference Machines (RIM), reconstructs two pixelated maps, one for the 
	background source and another for the mass density map of the foreground lensing galaxy. 
	This free-form parametric representation has the potential to reconstruct a large class 
	of gravitational lenses, including those with dark matter halos and subhalos, which 
	we demonstrate using realistic mass density profiles from the cosmological 
	hydrodynamic simulation IllustrisTNG.
	Our method can achieve an unmatched level of realism in a fraction of the time required by traditional methods, 
	which is a significant step 
	toward solving the challenge of studying such a large number of complex and varied 
	systems in a human timescale.
	
	\noindent
	\textbf{Keywords:} Gravitational lensing ---
		Astronomical simulations ---
		Nonparametric inference ---
		Convolutional Neural Networks.

    \end{abstract}

	\selectlanguage{french}
    \tableofcontents
    \listoftables
    \listoffigures
    %\printglossary[type=abbrev]
    \printglossaries
     \clearpage
    \begin{dedication}
      À Maman et Julia
    \end{dedication}
    \begin{acknowledgements}
            Je tiens à remercier ma superviseure, Laurence Perreault-Levasseur, 
            pour ces heures innombrables passées à discuter de ma recherche, à 
            me pousser et m'inspirer à réfléchir aux problèmes à toutes les échelles, des petits bugs 
            jusqu'aux problèmes les plus ambitieux.

             Je tiens à remercier Yashar Hezaveh, pour ses encouragements et 
             sa passion contagieuse pour la recherche, qui m'a infecté 
                même après deux ans d'isolation.

            Je tiens aussi à remercier mes collègues, Ronan Legin, Ève Campeau-Poirier et Charles Wilson 
            qui ont été là durant deux ans de pandémie pour parler de la vie, de la recherche 
            et de toutes les choses entre les deux, virtuellement ou autrement.
        
            Et surtout, merci à mes parents, mon frère et ma copine pour leur support inconditionnel 
            dans cette aventure que j'ai entrepris.
            
    \end{acknowledgements}
  \mainmatter
  \input{chapters/intro_wo_notes}
  \input{chapters/chap2_intro_lensing}
  \input{chapters/chap_intro_machine_learning}
  \input{chapters/chap3_intro_ml}
	\selectlanguage{english}
  \input{chapters/censai}
	\selectlanguage{french}
  \input{chapters/conclusion}
        %\selectlanguage{english}
  {\scriptsize
    \bibliography{intro_bib,censai_bib}
  }
  \appendix
  \input{chapters/annexe_planck}
  \selectlanguage{english}
  \input{chapters/censai_appendices}
\selectlanguage{french}
  \input{chapters/annexe_gru}
  \input{chapters/annexe_congres}
\end{document}

